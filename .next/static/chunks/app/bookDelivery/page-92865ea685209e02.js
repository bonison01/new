(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6078],{97138:(e,s,a)=>{Promise.resolve().then(a.bind(a,41216))},41216:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>_});var t=a(95155),n=a(12115),i=a(49047),r=a(15778),l=a(45530),o=a(27364),c=a(68736),d=a.n(c),p=a(48173),u=a.n(p);let h=["places"],m={width:"100%",height:"400px"},x={lat:28.6139,lng:77.209};function _(){let e=(0,r.R)(),[s,a]=(0,n.useState)({name:"",phone:"",address:"",instructions:""}),[c,p]=(0,n.useState)({name:"",phone:"",address:"",instructions:""}),[_,g]=(0,n.useState)(!1),[f,j]=(0,n.useState)(!1),[v,k]=(0,n.useState)(null),[N,b]=(0,n.useState)(null),[y,S]=(0,n.useState)(null),C=(0,n.useRef)(null),I=(0,n.useRef)(null),D=e=>{let t="pickup"===e?C.current:I.current;if(t){var n;let i=t.getPlace();if(null==i?void 0:null===(n=i.geometry)||void 0===n?void 0:n.location){let t=i.formatted_address||"";"pickup"===e&&a({...s,address:t}),"dropoff"===e&&p({...c,address:t})}}},w=s=>{"pickup"===s?(_?a({name:"",phone:"",address:"",instructions:""}):e&&a({...e,instructions:""}),g(!_)):(f?p({name:"",phone:"",address:"",instructions:""}):e&&p({...e,instructions:""}),j(!f))},F=async()=>{if(!s.address||!c.address||null===v||null===N){alert("Please fill in all the required details.");return}let e={pickup_name:s.name,pickup_phone:s.phone,pickup_address:s.address,dropoff_name:c.name,dropoff_phone:c.phone,dropoff_address:c.address,instructions:{pickup:s.instructions,dropoff:c.instructions},distance:v,charge:N};try{let{error:a}=await o.N.from("delivery_orders").insert(e);if(a)throw a;let t=await fetch("/api/send-telegram",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(s.name," → ").concat(c.name),message:"New Delivery:\nPickup: ".concat(s.address,"\nDropoff: ").concat(c.address,"\nDistance: ").concat(v.toFixed(2)," km\nCharge: ₹").concat(N.toFixed(2))})});if(!t.ok){let e=await t.text();throw Error("Telegram Error: ".concat(e))}alert("Booking confirmed and notification sent!")}catch(e){console.error(e),alert("An error occurred. Please try again.")}};return(0,t.jsx)(i.aJ,{googleMapsApiKey:"AIzaSyAVWx_5rh1jHYHCR-ghd5VFFc8nSve_1F0",libraries:h,children:(0,t.jsxs)("div",{className:d().container,children:[(0,t.jsxs)("div",{className:d().detailsWrapper,children:[(0,t.jsxs)("div",{className:d().detailsSection,children:[(0,t.jsx)("h2",{children:"Pickup Details"}),(0,t.jsxs)("label",{className:d().checkbox,children:[(0,t.jsx)("input",{type:"checkbox",checked:_,onChange:()=>w("pickup")}),"Same as My Details"]}),(0,t.jsx)(i.jT,{onLoad:e=>C.current=e,onPlaceChanged:()=>D("pickup"),children:(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Address",value:s.address,onChange:e=>a({...s,address:e.target.value})})}),(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Name",value:s.name,onChange:e=>a({...s,name:e.target.value})}),(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Phone",value:s.phone,onChange:e=>a({...s,phone:e.target.value})})]}),(0,t.jsxs)("div",{className:d().detailsSection,children:[(0,t.jsx)("h2",{children:"Drop-Off Details"}),(0,t.jsxs)("label",{className:d().checkbox,children:[(0,t.jsx)("input",{type:"checkbox",checked:f,onChange:()=>w("dropoff")}),"Same as My Details"]}),(0,t.jsx)(i.jT,{onLoad:e=>I.current=e,onPlaceChanged:()=>D("dropoff"),children:(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Address",value:c.address,onChange:e=>p({...c,address:e.target.value})})}),(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Name",value:c.name,onChange:e=>p({...c,name:e.target.value})}),(0,t.jsx)("input",{className:d().input,type:"text",placeholder:"Phone",value:c.phone,onChange:e=>p({...c,phone:e.target.value})})]})]}),(0,t.jsxs)("div",{className:d().mapSection,children:[(0,t.jsx)("h2",{children:"Map"}),(0,t.jsxs)(i.u6,{mapContainerStyle:m,center:x,zoom:8,children:[s.address&&c.address&&(0,t.jsx)(i.YK,{options:{origin:s.address,destination:c.address,travelMode:google.maps.TravelMode.DRIVING},callback:e=>{if((null==e?void 0:e.routes.length)>0){let s=e.routes[0].legs[0].distance.value/1e3;k(s),b((0,l.V)(s)),S(e)}}}),y&&(0,t.jsx)(i.C,{directions:y})]})]}),null!==v&&null!==N&&(0,t.jsxs)("div",{className:d().results,children:[(0,t.jsxs)("p",{children:["Distance: ",v.toFixed(2)," km"]}),(0,t.jsxs)("p",{children:["Delivery Charge: ₹",N.toFixed(2)]})]}),(0,t.jsx)("div",{className:d().buttons,children:(0,t.jsx)("button",{className:d().button,onClick:F,children:"Confirm Booking"})}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{className:d().cen,children:"For Delivery rates in PDF, click the links below"}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{children:(0,t.jsx)(u(),{href:"/standard.pdf",className:d().links,children:"Standard delivery rates."})}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{children:(0,t.jsx)(u(),{href:"/instant.pdf",className:d().links,children:"Instant delivery rates Outside Imphal."})}),(0,t.jsx)("div",{})]})})}},45530:(e,s,a)=>{"use strict";a.d(s,{V:()=>t});let t=e=>40+10*e},15778:(e,s,a)=>{"use strict";a.d(s,{R:()=>i});var t=a(12115),n=a(27364);let i=()=>{let[e,s]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email))return;let{data:a,error:t}=await n.N.from("users").select("name, phone, address").eq("email",e.email).single();t||s(a)})()},[]),e}},27364:(e,s,a)=>{"use strict";a.d(s,{N:()=>t});let t=(0,a(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},68736:e=>{e.exports={container:"page_container__cCBhR",title:"page_title__FDm9e",subtitle:"page_subtitle__bBViw",detailsWrapper:"page_detailsWrapper__IM8iV",detailsSection:"page_detailsSection__XEq5h",input:"page_input__xVoo3",textarea:"page_textarea__C321H",checkbox:"page_checkbox__trpoN",mapSection:"page_mapSection__meYg8",results:"page_results___WxEV",buttons:"page_buttons__BBRN4",button:"page_button__e8i51",fv:"page_fv__Lf3pC",links:"page_links__bkDm_",cen:"page_cen__XcTRG"}}},e=>{var s=s=>e(e.s=s);e.O(0,[1527,6084,5974,8173,8441,1517,7358],()=>s(97138)),_N_E=e.O()}]);