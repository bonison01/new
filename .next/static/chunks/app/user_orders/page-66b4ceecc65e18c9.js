(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9068],{10732:(e,t,a)=>{Promise.resolve().then(a.bind(a,56870))},56870:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(95155),n=a(12115),s=a(76046),l=a(27364),c=a(10142),d=a(92340),i=a.n(d),o=a(65972),h=a.n(o);function u(){let e;let[t,a]=(0,n.useState)([]),[d,o]=(0,n.useState)([]),[u,_]=(0,n.useState)(!0),[p,x]=(0,n.useState)(null),[j,m]=(0,n.useState)(""),[b,D]=(0,n.useState)(""),[O,g]=(0,n.useState)(""),[C,v]=(0,n.useState)(1),[N,S]=(0,n.useState)(""),[f,k]=(0,n.useState)(""),B=(0,s.useRouter)();(0,n.useEffect)(()=>{(async()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email)){B.push("/login");return}try{let{data:t,error:r}=await l.N.from("order_data").select("*").eq("vendor_email",e.email).order("created_at",{ascending:!0});if(r)throw Error(r.message);t&&(a(t),o(t))}catch(e){x(e instanceof Error?e.message:"An unexpected error occurred.")}finally{_(!1)}})()},[B]);let I=10*C,y=I-10,w=d.slice(y,I),F=Math.ceil(d.length/10),T=d.slice(0,I).reduce((e,t)=>e+(Number(t.tsb)||0),0);return u?(0,r.jsx)("p",{children:"Loading..."}):(0,r.jsxs)("div",{className:h().container,children:[(0,r.jsx)("h2",{className:h().title,children:"Your Orders"}),(0,r.jsx)("p",{className:h().mobileOnly,children:"Balance is the sum of TSB(Total Settlement Bill). For better version please check this layout onn desktop or download as pdf."}),(0,r.jsxs)("div",{className:h().bln,children:[(0,r.jsx)("strong",{children:"Running Balance:"})," ",T]}),(0,r.jsxs)("div",{className:h().filterContainer,children:[(0,r.jsxs)("div",{className:h().statusFilter,children:[(0,r.jsx)("label",{children:"Status:"}),(0,r.jsxs)("select",{value:b,onChange:e=>D(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"All"}),(0,r.jsx)("option",{value:"Pending",children:"Pending"}),(0,r.jsx)("option",{value:"Completed",children:"Completed"}),(0,r.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]}),(0,r.jsxs)("div",{className:h().createdDateFilter,children:[(0,r.jsx)("label",{children:"Created Date:"}),(0,r.jsx)("input",{type:"date",value:O,onChange:e=>g(e.target.value)})]}),(0,r.jsx)("button",{className:h().resetButton,onClick:()=>{m(""),D(""),g(""),S(""),k(""),o(t),v(1)},children:"Reset Filters"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{className:h().searchContainer,children:[(0,r.jsx)("input",{type:"text",className:h().searchInput,placeholder:"Search orders...",value:j,onChange:e=>m(e.target.value)}),(0,r.jsx)("button",{className:h().searchButton,onClick:()=>{let e=t;N&&f&&(e=e.filter(e=>{let t=new Date(e.created_at).toISOString().split("T")[0];return t>=N&&t<=f})),b&&(e=e.filter(e=>e.status===b)),O&&(e=e.filter(e=>new Date(e.created_at).toISOString().split("T")[0]===O)),""!==j.trim()&&(e=e.filter(e=>Object.values(e).join(" ").toLowerCase().includes(j.toLowerCase()))),o(e),v(1)},children:"Search"})]}),p&&(0,r.jsx)("p",{className:h().error,children:p}),0===d.length?(0,r.jsx)("p",{children:"No orders found for your criteria."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("table",{className:h().ordersTable,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"SL"}),(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Drop Details"}),(0,r.jsx)("th",{children:"Pickup Details"}),(0,r.jsx)("th",{children:"Order Type"}),(0,r.jsx)("th",{children:"PB Amount"}),(0,r.jsx)("th",{children:"DC Amount"}),(0,r.jsx)("th",{children:"TSB"}),(0,r.jsx)("th",{children:"Balance"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Created At"})]})}),(0,r.jsx)("tbody",{children:(e=d.slice(0,y).reduce((e,t)=>e+(Number(t.tsb)||0),0),w.map((t,a)=>{let n=Number(t.tsb)||0;return e+=n,(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:y+a+1}),(0,r.jsx)("td",{children:t.id}),(0,r.jsx)("td",{children:"".concat(t.drop_name||"",", ").concat(t.drop_address||"",", ").concat(t.drop_phone||"")}),(0,r.jsx)("td",{children:"".concat(t.pickup_name||"",", ").concat(t.pickup_address||"",", ").concat(t.pickup_phone||"")}),(0,r.jsx)("td",{children:t.orderType}),(0,r.jsx)("td",{children:"".concat(t.pbAmt||""," (").concat(t.pb||"",")")}),(0,r.jsx)("td",{children:"".concat(t.dcAmt||""," (").concat(t.dc||"",")")}),(0,r.jsx)("td",{children:n}),(0,r.jsx)("td",{children:e}),(0,r.jsx)("td",{children:t.status}),(0,r.jsx)("td",{children:new Date(t.created_at).toLocaleString()})]},t.id)}))})]}),(0,r.jsxs)("div",{className:h().pagination,children:[(0,r.jsx)("button",{disabled:1===C,onClick:()=>v(e=>Math.max(e-1,1)),children:"Previous"}),(0,r.jsxs)("span",{children:["Page ",C," of ",F]}),(0,r.jsx)("button",{disabled:C===F,onClick:()=>v(e=>Math.min(e+1,F)),children:"Next"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Running Balance:"})," ",T]}),(0,r.jsxs)("div",{className:h().dateRangeContainer,children:[(0,r.jsx)("label",{children:"Start Date:"}),(0,r.jsx)("input",{type:"date",value:N,onChange:e=>S(e.target.value)}),(0,r.jsx)("label",{children:"End Date:"}),(0,r.jsx)("input",{type:"date",value:f,onChange:e=>k(e.target.value)})]}),(0,r.jsx)("button",{className:h().downloadButton,onClick:()=>{let e=new c.default;e.text("Filtered Orders",10,10),i()(e,{head:[["ID","Drop Details","Pickup Details","Order Type","PB Amount","DC Amount","TSB","Balance","Status","Created At"]],body:d.map((e,t)=>{let a=d.slice(0,t+1).reduce((e,t)=>e+(Number(t.tsb)||0),0);return[e.id,"".concat(e.drop_name||"",", ").concat(e.drop_address||"",", ").concat(e.drop_phone||""),"".concat(e.pickup_name||"",", ").concat(e.pickup_address||"",", ").concat(e.pickup_phone||""),e.orderType,"".concat(e.pbAmt||""," (").concat(e.pb||"",")"),"".concat(e.dcAmt||""," (").concat(e.dc||"",")"),e.tsb,a,e.status,new Date(e.created_at).toLocaleString()]})}),e.save("filtered_orders.pdf")},children:"Download as PDF"})]})]})]})}},27364:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=(0,a(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},65972:e=>{e.exports={container:"OrderData_container__5mdT5",title:"OrderData_title__VDUvl",bln:"OrderData_bln__W_DIh",filterContainer:"OrderData_filterContainer__Ai6Mp",dateRangeContainer:"OrderData_dateRangeContainer__lQK86",statusFilter:"OrderData_statusFilter__nFcFJ",createdDateFilter:"OrderData_createdDateFilter__AkxYR",label:"OrderData_label__xwwOe",input:"OrderData_input__NqerW",select:"OrderData_select__ebkSn",resetButton:"OrderData_resetButton__8xsNM",searchContainer:"OrderData_searchContainer__shhSB",searchInput:"OrderData_searchInput__0cUEr",searchButton:"OrderData_searchButton__Vn0Zb",totalBalance:"OrderData_totalBalance__xOE7O",downloadButton:"OrderData_downloadButton__tPMW7",ordersTable:"OrderData_ordersTable__JGB_Y",pagination:"OrderData_pagination___c6UK",error:"OrderData_error__3fVZs",mobileOnly:"OrderData_mobileOnly__dljXy"}}},e=>{var t=t=>e(e.s=t);e.O(0,[7767,3930,5974,3737,8441,1517,7358],()=>t(10732)),_N_E=e.O()}]);