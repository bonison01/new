(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5555],{43071:(e,t,r)=>{Promise.resolve().then(r.bind(r,33300))},33300:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(95155),a=r(12115),l=r(76046),n=r(27364),o=r(96157);let i=e=>{let{product:t,onBuyNow:r,addCartIcon:l}=e,{addToCart:n}=(0,o._)(),[i,c]=(0,a.useState)(0);return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[(0,s.jsxs)("div",{className:"relative w-full h-64 overflow-hidden rounded-lg mb-4 group",children:[t.media_urls.map((e,r)=>{let a=r===i,o=/\.(mp4|webm|ogg)$/i.test(e);return(0,s.jsxs)("div",{className:"absolute inset-0 transition-opacity duration-300 ".concat(a?"opacity-100":"opacity-0"),children:[o?(0,s.jsx)("video",{src:e,controls:!0,muted:!0,loop:!0,className:"w-full h-full object-cover rounded-lg"}):(0,s.jsx)("img",{src:e,alt:"Product ".concat(t.id," - Media ").concat(r+1),className:"w-full h-full object-cover rounded-lg"}),l&&(0,s.jsx)("button",{className:"absolute top-2 right-2 bg-yellow-500 text-white p-2 rounded-full hover:bg-yellow-600",onClick:()=>n({id:t.id,name:t.name,price:t.price||"N/A",qty:1}),children:"\uD83D\uDED2"})]},r)}),t.media_urls.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{c(e=>0===e?t.media_urls.length-1:e-1)},className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75",children:"❮"}),(0,s.jsx)("button",{onClick:()=>{c(e=>(e+1)%t.media_urls.length)},className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75",children:"❯"})]})]}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-2 text-center",children:t.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4 text-center",children:t.description}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-4 text-center",children:["Rs. ",t.price_inr]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)("button",{onClick:()=>n({id:t.id,name:t.name,price:t.price||"N/A",qty:1}),className:"bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 flex-1",children:"Add to Cart \uD83D\uDED2"}),(0,s.jsx)("button",{onClick:()=>r(t),className:"bg-yellow-500 text-white py-2 px-4 rounded hover:bg-black hover:text-green-600 flex-1",children:"Buy Now"})]})]})},c=e=>{let{mediaUrls:t}=e,[r,l]=(0,a.useState)(0);return(0,s.jsxs)("div",{className:"relative w-full h-64 overflow-hidden rounded-lg mb-4",children:[t.map((e,t)=>{let a=t===r,l=/\.(mp4|webm|ogg)$/i.test(e);return(0,s.jsx)("div",{className:"absolute inset-0 transition-opacity duration-300 ".concat(a?"opacity-100":"opacity-0"),children:l?(0,s.jsx)("video",{src:e,controls:!0,muted:!0,loop:!0,className:"w-full h-full object-cover rounded-lg"}):(0,s.jsx)("img",{src:e,alt:"Media ".concat(t+1),className:"w-full h-full object-cover rounded-lg"})},t)}),t.length>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>{l(e=>0===e?t.length-1:e-1)},className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75",children:"❮"}),(0,s.jsx)("button",{onClick:()=>{l(e=>(e+1)%t.length)},className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-75",children:"❯"})]})]})},d=e=>{let{product:t,businessId:r,onClose:l}=e,[o,i]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[x,b]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[f,y]=(0,a.useState)(!1),[v,N]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{try{let{data:e,error:t}=await n.N.from("users").select("email").eq("user_id",r).single();if(t)throw t;e&&p(e.email)}catch(e){console.error("Error fetching receiver email:",e),alert("Unable to fetch receiver email.")}})()},[r]);let j=()=>"ORD-".concat(Math.floor(1e5+9e5*Math.random())),w=async e=>{e.preventDefault(),y(!0);let s=j(),a={order_id:s,product_id:t.id,product_name:t.name,quantity:parseInt(o,10),buyer_name:d,buyer_address:m,buyer_phone:x,business_id:r,receiver_email:g};try{let{data:e,error:t}=await n.N.from("orders").insert(a);if(t)throw t;N(s),alert("Order submitted successfully! Your Order ID is ".concat(s)),l()}catch(e){console.error("Error submitting order:",e),alert("Failed to submit order. Please try again.")}finally{y(!1)}};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Buy ",t.name]}),(0,s.jsx)(c,{mediaUrls:t.media_urls}),(0,s.jsxs)("form",{onSubmit:w,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"qty",className:"block text-sm font-medium text-gray-700",children:"Quantity"}),(0,s.jsx)("input",{type:"number",id:"qty",value:o,onChange:e=>i(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,s.jsx)("input",{type:"text",id:"name",value:d,onChange:e=>u(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,s.jsx)("input",{type:"text",id:"address",value:m,onChange:e=>h(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,s.jsx)("input",{type:"text",id:"phone",value:x,onChange:e=>b(e.target.value),className:"mt-1 block w-full p-2 border border-gray-300 rounded-md",required:!0})]}),(0,s.jsx)("button",{type:"submit",className:"bg-green-500 text-white py-2 px-4 rounded w-full hover:bg-green-600 ".concat(f?"opacity-50 cursor-not-allowed":""),disabled:f,children:f?"Submitting...":"Submit"}),(0,s.jsx)("button",{type:"button",onClick:l,className:"mt-4 bg-gray-300 text-black py-2 px-4 rounded hover:bg-gray-400 w-full",children:"Cancel"})]}),v&&(0,s.jsxs)("div",{className:"mt-4 bg-green-100 p-4 rounded text-green-700 text-center",children:["Your Order ID: ",(0,s.jsx)("strong",{children:v})]})]})})};function u(){var e;let{cart:t}=(0,o._)(),r=(0,l.useParams)(),[c,u]=(0,a.useState)(null),[m,h]=(0,a.useState)([]),[x,b]=(0,a.useState)(!0),[g,p]=(0,a.useState)(""),[f,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(null==r?void 0:r.user_id)try{let{data:e,error:t}=await n.N.from("users").select("*").eq("user_id",r.user_id).single();if(t)throw Error("Error fetching business details.");u(e);let{data:s,error:a}=await n.N.from("new_products").select("*").eq("user_id",r.user_id);if(a)throw Error("Error fetching products.");h(s||[])}catch(e){console.error(e)}finally{b(!1)}})()},[null==r?void 0:r.user_id]);let v=async()=>{if(!g||!(null==r?void 0:r.user_id))return;let e=[...(null==c?void 0:c.comments)||[],{user:"Anonymous",text:g}];await n.N.from("users").update({comments:e}).eq("user_id",r.user_id),u(t=>t?{...t,comments:e}:t),p("")};return x?(0,s.jsx)("div",{className:"text-center",children:"Loading..."}):c?(0,s.jsxs)("div",{className:"max-w-6xl mx-auto p-5",children:[(0,s.jsx)("div",{className:"fixed buttom-4 right-4",children:(0,s.jsx)("a",{href:"/cart",children:(0,s.jsxs)("button",{className:"bg-yellow-500 text-white p-2 rounded-full hover:bg-yellow-600",children:["\uD83D\uDED2 ",t.length]})})}),c.cover_photo_url?(0,s.jsx)("div",{className:"w-full h-80 overflow-hidden rounded-lg mb-5",children:(0,s.jsx)("img",{src:c.cover_photo_url,alt:"Cover Photo",className:"w-full h-full object-cover"})}):(0,s.jsx)("div",{className:"w-full h-80 flex items-center justify-center bg-gray-200 text-gray-500 text-lg rounded-lg mb-5",children:"No Cover Photo Available"}),(0,s.jsxs)("div",{className:"bg-white p-5 rounded-lg shadow mb-10",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-3",children:c.business_name}),(0,s.jsx)("p",{className:"text-lg text-gray-600 mb-2",children:c.product_service}),(0,s.jsxs)("p",{className:"text-gray-600 mb-2",children:["Address: ",c.business_address]}),(0,s.jsxs)("p",{className:"text-gray-600 mb-2",children:["Phone: ",c.phone]}),(0,s.jsxs)("p",{className:"text-gray-600",children:["Website:"," ",(0,s.jsx)("a",{href:c.website,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline",children:c.website})]})]}),(0,s.jsxs)("div",{className:"mb-10",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-5",children:"Products"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-5 justify-center",children:m.map(e=>(0,s.jsx)(i,{product:e,onBuyNow:y,addCartIcon:!0},e.id))})]}),(0,s.jsxs)("div",{className:"bg-white p-5 rounded-lg shadow",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-5",children:"Comments"}),(null===(e=c.comments)||void 0===e?void 0:e.length)?(0,s.jsx)("ul",{className:"space-y-4 mb-5",children:c.comments.map((e,t)=>(0,s.jsxs)("li",{className:"p-3 bg-gray-100 rounded-lg",children:[(0,s.jsxs)("strong",{className:"block text-gray-800",children:[e.user,":"]}),(0,s.jsx)("span",{className:"text-gray-600",children:e.text})]},t))}):(0,s.jsx)("p",{className:"text-gray-500",children:"No comments yet. Be the first to leave feedback!"}),(0,s.jsx)("textarea",{value:g,onChange:e=>p(e.target.value),placeholder:"Leave a comment...",className:"w-full p-3 border border-gray-300 rounded-lg mb-4 text-black py-2 px-4"}),(0,s.jsx)("button",{onClick:v,className:"bg-green-600 text-white py-2 px-4 rounded-lg",children:"Submit Comment"})]}),f&&(0,s.jsx)(d,{product:f,businessId:c.user_id,onClose:()=>y(null)})]}):(0,s.jsx)("div",{className:"text-center",children:"Business not found."})}},96157:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>o,_:()=>i});var s=r(95155),a=r(12115),l=r(9806);let n=(0,a.createContext)(void 0),o=e=>{let{children:t}=e,[r,o]=(0,a.useState)([]),i=(0,l.createClientComponentClient)();(0,a.useEffect)(()=>{let e=localStorage.getItem("cart");e&&o(JSON.parse(e))},[]),(0,a.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r))},[r]);let c=async e=>{let{data:t,error:r}=await i.from("new_products").select("name, price_inr").eq("id",e).single();return r?(console.error("Error fetching product details:",r.message),{name:"Unknown",price:void 0}):{name:t.name,price:t.price_inr}},d=async e=>{let t=await c(e.id);o(r=>r.find(t=>t.id===e.id)?r.map(t=>t.id===e.id?{...t,qty:t.qty+1}:t):[...r,{...e,...t,qty:1}])},u=r.reduce((e,t)=>e+(t.price?parseFloat(t.price)*t.qty:0),0);return(0,s.jsx)(n.Provider,{value:{cart:r,addToCart:d,updateQty:(e,t)=>{o(r=>r.map(r=>r.id===e?{...r,qty:t}:r))},removeFromCart:e=>{o(t=>t.filter(t=>t.id!==e))},clearCart:()=>o([]),totalPrice:u},children:t})},i=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("useCart must be used within a CartProvider");return e}},27364:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},76046:(e,t,r)=>{"use strict";var s=r(66658);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[5974,9806,8441,1517,7358],()=>t(43071)),_N_E=e.O()}]);