(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6638],{43506:(e,t,a)=>{Promise.resolve().then(a.bind(a,77776))},77776:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var l=a(95155),s=a(12115),n=a(76046),r=a(10142),i=a(92340),c=a.n(i);function o(){var e;let t;let[a,i]=(0,s.useState)(null),[o,d]=(0,s.useState)([]),[h,u]=(0,s.useState)([]),[x,m]=(0,s.useState)(null),[j,p]=(0,s.useState)(0),[g,v]=(0,s.useState)(1),[f,b]=(0,s.useState)(1),[N,S]=(0,s.useState)(1),[C,w]=(0,s.useState)(""),_=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email)){_.push("/login");return}i(e.email),async function(){try{let t=await fetch("/api/sheets");if(!t.ok){let e=await t.text();throw Error("HTTP error! Status: ".concat(t.status,", Details: ").concat(e))}let a=(await t.json()).data.filter(t=>{var a;return(null===(a=t[3])||void 0===a?void 0:a.trim())===e.email.trim()}),l=a.slice(1).reduce((e,t)=>e+(parseFloat(t[4])||0),0);d(a),u(a),p(l)}catch(e){console.error("Error fetching data:",e),m("Failed to fetch data: ".concat(String(e)))}}()},[_]);let k=Math.ceil((h.length-1)/15),y=h.slice(1+(g-1)*15,1+15*g);return(0,l.jsxs)("div",{className:"container",children:[(0,l.jsx)("h1",{className:"title",children:"My Google Sheets Data"}),a&&(0,l.jsxs)("p",{className:"info",children:["Logged in as: ",(0,l.jsx)("strong",{children:a})]}),(0,l.jsxs)("p",{className:"total-balance",children:[(0,l.jsx)("strong",{children:"Total Balance:"})," ",j.toFixed(2)]}),x?(0,l.jsx)("p",{className:"error",children:x}):h.length>1?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"search-container",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search...",value:C,onChange:e=>w(e.target.value)}),(0,l.jsx)("button",{onClick:()=>{if(""===C.trim())u(o);else{let e=C.toLowerCase();u(o.filter(t=>t.some(t=>t.toLowerCase().includes(e)))),v(1)}},children:"Search"})]}),(0,l.jsxs)("table",{className:"styled-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"SL No."}),null===(e=h[0])||void 0===e?void 0:e.map((e,t)=>(0,l.jsx)("th",{children:e},t)),(0,l.jsx)("th",{children:"Cumulative Balance"})]})}),(0,l.jsx)("tbody",{children:(t=h.slice(1,1+(g-1)*15).reduce((e,t)=>e+(parseFloat(t[4])||0),0),y.map((e,a)=>{let s=parseFloat(e[4])||0;return t+=s,(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(g-1)*15+a+1})," ",e.map((e,t)=>(0,l.jsx)("td",{children:e},t)),(0,l.jsx)("td",{children:t.toFixed(2)})]},a)}))})]}),(0,l.jsxs)("div",{className:"pagination",children:[(0,l.jsx)("button",{disabled:1===g,onClick:()=>v(e=>Math.max(e-1,1)),children:"Previous"}),(0,l.jsxs)("span",{children:["Page ",g," of ",k]}),(0,l.jsx)("button",{disabled:g===k,onClick:()=>v(e=>Math.min(e+1,k)),children:"Next"})]}),(0,l.jsxs)("div",{className:"pdf-selection",children:[(0,l.jsx)("label",{children:"From Page:"}),(0,l.jsx)("input",{type:"number",value:f,onChange:e=>b(Number(e.target.value)),min:1,max:k}),(0,l.jsx)("label",{children:"To Page:"}),(0,l.jsx)("input",{type:"number",value:N,onChange:e=>S(Number(e.target.value)),min:1,max:k}),(0,l.jsx)("button",{onClick:()=>{if(f<1||N>k||f>N){alert("Invalid page range selected.");return}let e=new r.default;e.text("Data from Page ".concat(f," to ").concat(N),10,10);let t=[];for(let e=f;e<=N;e++){let a=1+(e-1)*15,l=1+15*e;t.push(...h.slice(a,l))}c()(e,{head:[["SL No.",...o[0]]],body:t.map((e,t)=>[t+1,...e])}),e.save("data_pages_".concat(f,"_to_").concat(N,".pdf"))},children:"Download PDF"})]})]}):(0,l.jsx)("p",{children:"No data available for the logged-in user."})]})}a(2584)},2584:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[25,3930,3737,8441,1517,7358],()=>t(43506)),_N_E=e.O()}]);