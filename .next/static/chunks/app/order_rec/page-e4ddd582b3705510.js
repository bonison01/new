(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7612],{11512:(e,t,s)=>{Promise.resolve().then(s.bind(s,5678))},5678:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(95155),r=s(12115),l=s(27364),d=s(19094),i=s.n(d);function n(){let[e,t]=(0,r.useState)([]),[s,d]=(0,r.useState)(!0),[n,c]=(0,r.useState)(null),[o,h]=(0,r.useState)(null),[u,m]=(0,r.useState)(""),[_,x]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email)){alert("Please log in to view orders.");return}try{let{data:s,error:a}=await l.N.from("order_rec").select("*").eq("email",e.email);if(a)throw Error(a.message);if(s){let e=s.sort((e,t)=>"Pending"===e.status?-1:"Pending"===t.status?1:0);t(e)}}catch(e){e instanceof Error?c(e.message):c("An unexpected error occurred.")}finally{d(!1)}})()},[]);let j=e=>{h(e),m(e.status||""),x("")},p=async()=>{if(!o)return;let e=""!==_?new Date(_).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"",s="Dispatched with date"===u||"Delivered with date"===u?"".concat(u.split(" ")[0]," ").concat(e):u;try{let{error:e}=await l.N.from("order_rec").update({status:s}).eq("id",o.id);if(e)throw Error(e.message);t(e=>e.map(e=>e.id===o.id?{...e,status:s}:e)),h(null),alert("Status updated successfully!")}catch(e){console.error("Error updating status:",e),alert("Failed to update status. Please try again.")}};return s?(0,a.jsx)("p",{children:"Loading..."}):(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsx)("h2",{className:i().title,children:"Orders for Your Business"}),n&&(0,a.jsx)("p",{className:i().error,children:n}),(0,a.jsxs)("table",{className:i().ordersTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Order ID"}),(0,a.jsx)("th",{children:"Buyer Name"}),(0,a.jsx)("th",{children:"Address"}),(0,a.jsx)("th",{children:"Phone"}),(0,a.jsx)("th",{children:"Total Price"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Items"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.order_id}),(0,a.jsx)("td",{children:e.buyer_name}),(0,a.jsx)("td",{children:e.buyer_address}),(0,a.jsx)("td",{children:e.buyer_phone}),(0,a.jsxs)("td",{children:["$",e.total_price]}),(0,a.jsx)("td",{children:e.status||"Pending"}),(0,a.jsx)("td",{children:(0,a.jsxs)("details",{children:[(0,a.jsx)("summary",{children:"View Items"}),(0,a.jsx)("ul",{children:e.item_list.map(e=>(0,a.jsxs)("li",{children:[e.name," - ",e.quantity," pcs - $",e.total]},e.id))})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{onClick:()=>j(e),className:i().editButton,children:"Edit"})})]},e.id))})]}),o&&(0,a.jsx)("div",{className:i().modal,children:(0,a.jsxs)("div",{className:i().modalContent,children:[(0,a.jsxs)("h3",{children:["Edit Status for Order ",o.order_id]}),(0,a.jsxs)("label",{className:i().modalLabel,children:["New Status:",(0,a.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:i().modalSelect,children:[(0,a.jsx)("option",{value:"In-Progress",children:"In-Progress"}),(0,a.jsx)("option",{value:"Dispatched with date",children:"Dispatched with date"}),(0,a.jsx)("option",{value:"Delivered with date",children:"Delivered with date"})]})]}),("Dispatched with date"===u||"Delivered with date"===u)&&(0,a.jsxs)("label",{className:i().modalLabel,children:["Date:",(0,a.jsx)("input",{type:"date",value:_,onChange:e=>x(e.target.value),className:i().modalInput})]}),(0,a.jsxs)("div",{className:i().modalActions,children:[(0,a.jsx)("button",{onClick:p,className:i().saveButton,children:"Save"}),(0,a.jsx)("button",{onClick:()=>h(null),className:i().cancelButton,children:"Cancel"})]})]})})]})}},27364:(e,t,s)=>{"use strict";s.d(t,{N:()=>a});let a=(0,s(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},19094:e=>{e.exports={container:"OrdersPage_container__jGJ_T",ordersTable:"OrdersPage_ordersTable__lptP6",title:"OrdersPage_title__EJ5wn",error:"OrdersPage_error__RvB0P",modal:"OrdersPage_modal__pPZ9I",modalContent:"OrdersPage_modalContent__ZDXLx",modalLabel:"OrdersPage_modalLabel__c_XR4",modalSelect:"OrdersPage_modalSelect__YQLS0",modalInput:"OrdersPage_modalInput__G2HDB",modalActions:"OrdersPage_modalActions__5_hTr",saveButton:"OrdersPage_saveButton__lauIO",cancelButton:"OrdersPage_cancelButton__PRno_",editButton:"OrdersPage_editButton__ltIXu",mobileRecord:"OrdersPage_mobileRecord__eTvmU"}}},e=>{var t=t=>e(e.s=t);e.O(0,[1969,5974,8441,1517,7358],()=>t(11512)),_N_E=e.O()}]);