(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2524],{84940:(e,t,a)=>{Promise.resolve().then(a.bind(a,96718))},96718:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(95155),r=a(12115),l=a(76046);function n(){var e;let t;let[a,n]=(0,r.useState)(null),[i,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(0),[x,m]=(0,r.useState)(1),j=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email)){j.push("/login");return}n(e.email),async function(){try{let t=await fetch("/api/sheets");if(!t.ok){let e=await t.text();throw Error("HTTP error! Status: ".concat(t.status,", Details: ").concat(e))}let a=(await t.json()).data.filter(t=>{var a;return(null===(a=t[3])||void 0===a?void 0:a.trim())===e.email.trim()}),s=a.slice(1).reduce((e,t)=>e+(parseFloat(t[4])||0),0);c(a),h(s)}catch(e){console.error("Error fetching data:",e),d("Failed to fetch data: ".concat(String(e)))}}()},[j]);let f=Math.ceil((i.length-1)/15),g=i.slice(1+(x-1)*15,1+15*x);return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("h1",{className:"title",children:"My Google Sheets Data"}),a&&(0,s.jsxs)("p",{className:"info",children:["Logged in as: ",(0,s.jsx)("strong",{children:a})]}),(0,s.jsxs)("p",{className:"total-balance",children:[(0,s.jsx)("strong",{children:"Total Balance:"})," ",u.toFixed(2)]}),o?(0,s.jsx)("p",{className:"error",children:o}):i.length>1?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("table",{className:"styled-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[null===(e=i[0])||void 0===e?void 0:e.map((e,t)=>(0,s.jsxs)("th",{children:[e,4===t&&" (Balance)"," "]},t)),(0,s.jsx)("th",{children:"Balance Extra"})]})}),(0,s.jsx)("tbody",{children:(t=0,g.map((e,a)=>{let r=parseFloat(e[4])||0;return t+=r,(0,s.jsxs)("tr",{children:[e.map((e,t)=>(0,s.jsx)("td",{children:e},t)),(0,s.jsx)("td",{children:t.toFixed(2)})," "]},a)}))})]}),(0,s.jsxs)("div",{className:"pagination",children:[(0,s.jsx)("button",{disabled:1===x,onClick:()=>m(e=>Math.max(e-1,1)),children:"Previous"}),(0,s.jsxs)("span",{children:["Page ",x," of ",f]}),(0,s.jsx)("button",{disabled:x===f,onClick:()=>m(e=>Math.min(e+1,f)),children:"Next"})]})]}):(0,s.jsx)("p",{children:"No data available for the logged-in user."})]})}a(87206)},76046:(e,t,a)=>{"use strict";var s=a(66658);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},87206:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[9295,8441,1517,7358],()=>t(84940)),_N_E=e.O()}]);