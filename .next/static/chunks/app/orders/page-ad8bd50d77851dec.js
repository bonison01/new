(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1778],{44910:(e,s,t)=>{Promise.resolve().then(t.bind(t,18964))},18964:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(95155),a=t(12115),d=t(27364),l=t(2082),n=t.n(l);function i(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!0),[i,c]=(0,a.useState)(null),[o,h]=(0,a.useState)(null),[u,m]=(0,a.useState)(""),[j,_]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{let e=JSON.parse(sessionStorage.getItem("user")||"{}");if(!(null==e?void 0:e.email)){alert("Please log in to view orders.");return}try{let{data:t,error:r}=await d.N.from("orders").select("*").eq("receiver_email",e.email);if(r)throw Error(r.message);if(t){let e=t.sort((e,s)=>"Pending"===e.status?-1:"Pending"===s.status?1:0);s(e)}}catch(e){e instanceof Error?c(e.message):c("An unexpected error occurred.")}finally{l(!1)}})()},[]);let x=e=>{h(e),m(e.status||""),_("")},p=async()=>{if(!o)return;let e=""!==j?new Date(j).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"",t="Dispatched with date"===u||"Delivered with date"===u?"".concat(u.split(" ")[0]," ").concat(e):u;try{let{error:e}=await d.N.from("orders").update({status:t}).eq("id",o.id);if(e)throw Error(e.message);s(e=>e.map(e=>e.id===o.id?{...e,status:t}:e)),h(null),alert("Status updated successfully!")}catch(e){console.error("Error updating status:",e),alert("Failed to update status. Please try again.")}};return t?(0,r.jsx)("p",{children:"Loading..."}):(0,r.jsxs)("div",{className:n().container,children:[(0,r.jsx)("h2",{className:n().title,children:"Orders for Your Business"}),i&&(0,r.jsx)("p",{className:n().error,children:i}),(0,r.jsxs)("table",{className:n().ordersTable,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Order ID"}),(0,r.jsx)("th",{children:"Product Name"}),(0,r.jsx)("th",{children:"Quantity"}),(0,r.jsx)("th",{children:"Buyer Name"}),(0,r.jsx)("th",{children:"Address"}),(0,r.jsx)("th",{children:"Phone"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.order_id}),(0,r.jsx)("td",{children:e.product_name}),(0,r.jsx)("td",{children:e.quantity}),(0,r.jsx)("td",{children:e.buyer_name}),(0,r.jsx)("td",{children:e.buyer_address}),(0,r.jsx)("td",{children:e.buyer_phone}),(0,r.jsx)("td",{children:e.status||"Pending"}),(0,r.jsx)("td",{children:(0,r.jsx)("button",{onClick:()=>x(e),className:n().editButton,children:"Edit"})})]},e.id))})]}),e.map(e=>(0,r.jsxs)("div",{className:n().mobileRecord,children:[(0,r.jsxs)("h3",{children:["Order ID: ",e.order_id]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Product Name:"})," ",e.product_name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Quantity:"})," ",e.quantity]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Buyer Name:"})," ",e.buyer_name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Address:"})," ",e.buyer_address]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Phone:"})," ",e.buyer_phone]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{children:"Status:"})," ",e.status||"Pending"]}),(0,r.jsx)("button",{onClick:()=>x(e),className:n().editButton,children:"Edit"})]},e.id)),o&&(0,r.jsx)("div",{className:n().modal,children:(0,r.jsxs)("div",{className:n().modalContent,children:[(0,r.jsxs)("h3",{children:["Edit Status for Order ",o.order_id]}),(0,r.jsxs)("label",{className:n().modalLabel,children:["New Status:",(0,r.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:n().modalSelect,children:[(0,r.jsx)("option",{value:"In-Progress",children:"In-Progress"}),(0,r.jsx)("option",{value:"Dispatched with date",children:"Dispatched with date"}),(0,r.jsx)("option",{value:"Delivered with date",children:"Delivered with date"})]})]}),("Dispatched with date"===u||"Delivered with date"===u)&&(0,r.jsxs)("label",{className:n().modalLabel,children:["Date:",(0,r.jsx)("input",{type:"date",value:j,onChange:e=>_(e.target.value),className:n().modalInput})]}),(0,r.jsxs)("div",{className:n().modalActions,children:[(0,r.jsx)("button",{onClick:p,className:n().saveButton,children:"Save"}),(0,r.jsx)("button",{onClick:()=>h(null),className:n().cancelButton,children:"Cancel"})]})]})})]})}},27364:(e,s,t)=>{"use strict";t.d(s,{N:()=>r});let r=(0,t(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},2082:e=>{e.exports={container:"OrdersPage_container__GPJ6W",ordersTable:"OrdersPage_ordersTable__JvhrC",title:"OrdersPage_title__hsj1T",error:"OrdersPage_error__ksjDE",modal:"OrdersPage_modal__i30Zr",modalContent:"OrdersPage_modalContent__sT5Ds",modalLabel:"OrdersPage_modalLabel__VzdUu",modalSelect:"OrdersPage_modalSelect__hfjjm",modalInput:"OrdersPage_modalInput__wyd5E",modalActions:"OrdersPage_modalActions__0h8NQ",saveButton:"OrdersPage_saveButton__QvkzA",cancelButton:"OrdersPage_cancelButton__K9r7H",editButton:"OrdersPage_editButton__rCdO8",mobileRecord:"OrdersPage_mobileRecord__FSuVA"}}},e=>{var s=s=>e(e.s=s);e.O(0,[7609,5974,8441,1517,7358],()=>s(44910)),_N_E=e.O()}]);