(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7677],{77677:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var n=a(95155),s=a(12115),i=a(66756),l=a(90833),c=a(15402),o=a(13710),r=a(63314),u=a(37288),d=a(21752),g=a.n(d);a(27364),a(68413);var p=a(40281),h=a.n(p),m=a(27052);let x=()=>{let[e,t]=(0,s.useState)(""),[a,d]=(0,s.useState)(""),[p,x]=(0,s.useState)(null),[_,j]=(0,s.useState)(null),[C,v]=(0,s.useState)([]),[y,I]=(0,s.useState)([]),[N,S]=(0,s.useState)(!1),[k,D]=(0,s.useState)(!1),[f,w]=(0,s.useState)(null),[b,E]=(0,s.useState)(null),[z,F]=(0,s.useState)([]),J={lat:24.817,lng:93.936},G=async(e,t)=>{try{let a=await fetch("/api/autocomplete?input=".concat(e,"&location=").concat(J.lat,",").concat(J.lng));if(!a.ok){console.error("Error fetching suggestions:",a.statusText);return}let n=(await a.json()).predictions.map(e=>({description:e.description,latitude:e.geometry.location.lat,longitude:e.geometry.location.lng}));t?(v(n),S(!0)):(I(n),D(!0))}catch(e){console.error("Fetch error:",e)}},L=async()=>{if(w("Calculating..."),!p||!_){console.error("Both origin and destination coordinates are required");return}let e="".concat(p.lat,",").concat(p.lng),t="".concat(_.lat,",").concat(_.lng);try{let a=await fetch("/api/distance-matrix?origin=".concat(e,"&destination=").concat(t));if(!a.ok){let e=await a.text();console.error("Error fetching distance:",a.statusText,e),w("Error calculating distance");return}let n=await a.json(),s=(n.rows[0].elements[0].distance/1e3).toFixed(2);w("".concat(s," km"));let i=n.rows[0].elements[0].polyline,l=g().decode(i);F(l),T(s)}catch(e){console.error("Fetch error:",e),w("Error calculating distance")}},M=e=>(0,m.getDistance)(J,e)/1e3,T=e=>{let t=parseFloat(e),a=p?M(p):0,n=_?M(_):0,s=0;s=t<=5?27+(t-0)*10:t<=20?77+(t-5)*15:t<=35?302+(t-20)*20:t>35&&t<=40?602+(t-35)*50:852+(t-40)*60,a<=5&&n<=5&&s>100?E("₹100"):E("₹".concat(s.toFixed(2)))},Y=async(e,t)=>{try{let a=await fetch("/api/reverse-geocode?lat=".concat(e.lat,"&lng=").concat(e.lng)),n=await a.json();t(n.place_name||"Selected Location")}catch(e){console.error("Error reverse geocoding:",e),t("Selected Location")}};return(0,n.jsxs)("div",{className:h().container,children:[(0,n.jsxs)("div",{className:h().inputSection,children:[(0,n.jsxs)("div",{className:h().inputGroup,children:[(0,n.jsx)("input",{type:"text",value:e,onChange:e=>{t(e.target.value),G(e.target.value,!0)},className:h().input,placeholder:"Enter origin"}),N&&(0,n.jsx)("ul",{className:h().suggestionsList,children:C.map((e,a)=>(0,n.jsx)("li",{className:h().suggestionItem,onClick:()=>{t(e.description),x({lat:e.latitude,lng:e.longitude}),S(!1)},children:e.description},a))})]}),(0,n.jsxs)("div",{className:h().inputGroup,children:[(0,n.jsx)("input",{type:"text",value:a,onChange:e=>{d(e.target.value),G(e.target.value,!1)},className:h().input,placeholder:"Enter destination"}),k&&(0,n.jsx)("ul",{className:h().suggestionsList,children:y.map((e,t)=>(0,n.jsx)("li",{className:h().suggestionItem,onClick:()=>{d(e.description),j({lat:e.latitude,lng:e.longitude}),D(!1)},children:e.description},t))})]}),(0,n.jsx)("button",{onClick:L,className:h().button,children:"Calculate"}),f&&(0,n.jsxs)("p",{className:h().distance,children:["Distance: ",f]}),b&&(0,n.jsxs)("p",{className:h().deliveryCharge,children:["Delivery Charge: ",b]})]}),(0,n.jsx)("div",{className:h().mapContainer,children:(0,n.jsxs)(l.W,{center:[24.817,93.936],zoom:13,scrollWheelZoom:!0,style:{height:"100%",width:"100%"},children:[(0,n.jsx)(c.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,n.jsx)(()=>((0,i.Po)({click(e){let a={lat:e.latlng.lat,lng:e.latlng.lng};p?(j(a),Y(a,d)):(x(a),Y(a,t))}}),null),{}),(0,n.jsx)(()=>{let e=(0,i.ko)();return(0,s.useEffect)(()=>{e&&e.invalidateSize()},[p,_,z,e]),null},{}),p&&(0,n.jsx)(o.p,{position:[p.lat,p.lng],children:(0,n.jsx)(r.z,{children:"Origin"})}),_&&(0,n.jsx)(o.p,{position:[_.lat,_.lng],children:(0,n.jsx)(r.z,{children:"Destination"})}),z.length>0&&(0,n.jsx)(u.R,{positions:z,color:"blue"})]})})]})}},27364:(e,t,a)=>{"use strict";a.d(t,{N:()=>n});let n=(0,a(35974).UU)("https://mdxeolqfiosscdommyhc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1keGVvbHFmaW9zc2Nkb21teWhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk4ODc2NDMsImV4cCI6MjA0NTQ2MzY0M30.6FDluVEiMbeaxQI9BD633IhtxnEwh3f5WzGT5YDOylA",{auth:{persistSession:!0,autoRefreshToken:!0}})},40281:e=>{e.exports={container:"DistanceCalculator_container__9Y2Ve",distanceText:"DistanceCalculator_distanceText__pn1A5",deliveryCharge:"DistanceCalculator_deliveryCharge__Qp8mi",inputSection:"DistanceCalculator_inputSection__C2msr",inputGroup:"DistanceCalculator_inputGroup__YYP6U",suggestionsList:"DistanceCalculator_suggestionsList__VwsR9",suggestionItem:"DistanceCalculator_suggestionItem__7PvU9",button:"DistanceCalculator_button__uJm_8",mapContainer:"DistanceCalculator_mapContainer__elvk6"}}}]);